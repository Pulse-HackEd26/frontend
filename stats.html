<!DOCTYPE html>

<link rel="stylesheet" href="css/stylesheet.css">
<link rel="stylesheet" href="css/navbar.css">

<header>
    <button class="logout" id="qlogout" onclick="logout()"> Logout <i class="nf nf-md-logout_variant"></i> </button>
    <div class="topbar"></div>
    <div class="logotext">

        <img width=450 src="logo_subtext.png"/>
    </div>
</header>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
<body>
<div class="graphsubtext">
    <h3> Your Weekly Overview </h3>
</div>
<div class="graphtext">
    <canvas id="myChart" style="width:100%;max-width:600px"></canvas>
</div>
<div class="graphsubtext">
    <button class="logout" id="qlogout" onclick="back()"> <i class="nf nf-md-keyboard_backspace"></i> Back to homepage </button>
    <a href="./home.html">  </a>
</div>



</body>
<script>

        function logout() {
            window.location.replace("./index.html");
            document.cookie = "questionnairecompleted=" + "false";
            var a = cookie;
            document.cookie = cookie;

        }
function getCookie(cname) {
  let name = cname + "=";
  let decodedCookie = decodeURIComponent(document.cookie);
  let ca = decodedCookie.split(';');
  for(let i = 0; i <ca.length; i++) {
    let c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
}
async function getResults() {
    const response = await fetch(`http://127.0.0.1:8080/readForm/${getCookie("username")}`);
    //console.log(await response.json());
    var value = await response.json()//["burnoutscore"];

    var valuesl = value.length

    var values = [
        0,0,0,0,0,0,0
    ];
    for (let i = 0; i < 7; i++) {
      if (i < valuesl) {
        values[i] = Number(value[i]["burnoutscore"]);
      }
      else {
        values[i] = 0;
      }

    }

    const xValues = [1,2,3,4,5,6,7];

    new Chart("myChart", {
      type: "line",
      data: {
        labels: xValues,
        datasets: [{
          data: values.reverse(),
          borderColor: "#18A999",
          fill: true
        }]
      },
      options: {
        legend: {display: false}
      }
    });

}

function back() {
    window.location.replace("./home.html");
}
getResults()

</script>

</html>
